@startuml


[*] --> DEVICE_OFF

state DEVICE_OFF
state SCANNING
state CHANNEL_LIST
state CLIENT_REGISTRATION
state AUTHORIZATION_INIT

SCANNING: + onEnter: getChannelList

CHANNEL_LIST: +onEnter: displayChannelList

CLIENT_REGISTRATION: + onEnter: requestClientInformation

AUTHORIZATION_INIT: + onEnter: requestUserCode(ClientId)
AUTHORIZATION_PENDING: + onEnter: displayUserCode

state AUTHORIZATION_PENDING
state SUCCESSFUL_PAIRING
state ERROR

DEVICE_OFF -[#blue]-> DEVICE_ON: switch_on
DEVICE_ON --> SCANNING
SCANNING --> CHANNEL_LIST: onLoaded
SCANNING -right-> ERROR: No channel

CHANNEL_LIST -[#blue]-> CLIENT_REGISTRATION: onChannelClick [!isRegistered]
CHANNEL_LIST -[#blue]-> AUTHORIZATION_INIT: onChannelClick [isRegistered]

CLIENT_REGISTRATION --> AUTHORIZATION_INIT: onReply [200 OK]
CLIENT_REGISTRATION --> ERROR: onReply [*]

AUTHORIZATION_INIT --> AUTHORIZATION_PENDING: onReply [200 OK]
AUTHORIZATION_INIT --> ERROR: onReply [*]

AUTHORIZATION_PENDING -[#blue]-> SUCCESSFUL_PAIRING: onValidatePairingClick [200 OK]
AUTHORIZATION_PENDING -[#blue]-> AUTHORIZATION_PENDING: onValidatePairingClick [*]

SUCCESSFUL_PAIRING --> [*]

legend left

CPA Client

Note:
- Transition format: "trigger [guard] /effect"
- Blue arrows are user actions (ie click)
endlegend



' note right of STATE: "transition: trigger[guard]/effect"

@enduml
